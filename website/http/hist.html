<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<title>Portal Gun 2.0</title>
<link rel="stylesheet" type="text/css" href="portalstyle.css">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="dropit/dropit.css" type="text/css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script src="dropit/dropit.js"></script>
<script src="portal.js"></script>
</head>
<body>

<div id="menudiv">
<ul class="menu">
<li>
<a><i id="menuicon" class="fa fa-chevron-down"></i></a>
<ul>
<li><a href="index.html"><i class="fa fa-home fa-fw"></i> Home</a></li>
<li><a href="hist.html"><i class="fa fa-history fa-fw"></i> History</a></li>
<li><a href="https://github.com/Swap-File/portal-gun-2"><i class="fa fa-code fa-fw"></i> View Code</a></li>
<li><a href="http://192.168.1.22"><i class="fa fa-wrench fa-fw"></i> Gordon</a></li>
<li><a href="http://192.168.1.23"><i class="fa fa-wrench fa-fw"></i> Chell</a></li>
</ul>
</li>
</ul>
<div id="menutxt">Menu</div>
</div>


<div class="portalguy" onclick="portal_guy_click()">
<img id="leftlogo" alt="" src="assets/lb.png">
<img id="rightlogo" alt="" src="assets/ro.png" >
<div id="loadingtxt">Loading</div>
</div>

<div id="titletext">Portal Guns 2.0</div>


<div id="timestampdiv"></div>
<div id="gordonstats"></div>
<div id="chellstats"></div>

<input class="histbutton" type="button" onclick="loaddata2(2);" value="<<" style="width:40px;">
<input class="histbutton" type="button" onclick="loaddata2(-1);" value="<" style="width:40px;">
<input id="currentid" type="number" min="0" value="0" style="width:50px;" onchange="updatepage(this)">
<input class="histbutton" type="button" onclick="loaddata2(1);" value= ">" style="width:40px;">
<input class="histbutton" type="button" onclick="loaddata2(2);" value=">>" style="width:40px;">
<br>
<img class="portal_image" id="portal_back" alt="" src="assets/blank.png">
<img class="portal_image" id="portal_front" alt="" src="assets/orange_portal.png">

<div class="portal_image" id="portaloverlay">

</div>

<script>


loaddata(-1);

function updatepage(element) {
	loaddata(element.value);
}

function loaddata2(num){
	currentid.value = parseInt(currentid.value) + num;
	loaddata(currentid.value);
}

function loaddata(number) {
	$('#loadingtxt').stop(true,true).show();
	$.post('index_get.php', {id: number,live: 0}, function(data) {
		var line = data.split("\t");
		if (line.length == 17){
		
			var timestamp = line[0];
			var id = parseInt(line[1]);
			var synced = parseInt(line[2]);
			
			var g_live = parseInt(line[3]);
			var g_time = line[4];
			var g_lag = parseFloat(line[5]);
			var g_volts = parseFloat(line[6]);
			var g_temp1 = parseFloat(line[7]);
			var g_temp2 = parseFloat(line[8]);
			
			var c_live = parseInt(line[9]);
			var c_time = line[10];
			var c_lag = parseFloat(line[11]);
			var c_volts = parseFloat(line[12]);
			var c_temp1 = parseFloat(line[13]);
			var c_temp2 = parseFloat(line[14]);
			
			var g_state = parseFloat(line[15]);
			var c_state = parseFloat(line[16]);
			
			currentid.value = id;
			timestampdiv.innerHTML = timestamp;
			
			if (g_live){
				gordonstats.innerHTML = "Gordon: " + g_volts + "V " + g_lag + "ms " + g_temp1 + "F " + g_temp2 + "F";
			}else{
				gordonstats.innerHTML = "Gordon Last Seen at " + g_time;
			}
			if (c_live){
				chellstats.innerHTML = "Chell: " + c_volts + "V " + c_lag + "ms " + c_temp1 + "F " + c_temp2 + "F";
			}else{
				chellstats.innerHTML = "Chell Last Seen at " + c_time;
			}
			
			if (g_state < 0 ){
				portal_front.src = "assets/orange_portal.png"
				portal_back.src = "getimage.php?id=" +id;
				$(".menu ul.dropit-submenu a").removeClass("orange");
				$(".menu ul.dropit-submenu a").addClass("blue");
				portal_color_saved = 0;
			}else if (c_state < 0){
				portal_color_saved = 1;
				portal_front.src = "assets/blue_portal.png"
				portal_back.src = "getimage.php?id=" +id;
				$(".menu ul.dropit-submenu a").removeClass("blue");
				$(".menu ul.dropit-submenu a").addClass("orange");
			}else{
				if (synced == 1){
					if (portal_color_saved == 1 ){
						portal_back.src = "assets/blue_0.jpg";
					}else if (portal_color_saved == 0){
						portal_back.src  = "assets/orange_0.jpg"; 
					}
				}else{
					portal_back.src  = "assets/blank.png"; 
				}				
			}		
		}
		setTimeout(fadeit,300);
	});
}

</script>
</body>
</html>