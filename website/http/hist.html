<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<title>Portal Gun 2.0</title>
<link rel="stylesheet" type="text/css" href="portalstyle.css">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
</head>
<body>

<div class="container">
<img class="floatleft" id="leftlogo" alt="" src="assets/lb.png" onclick="magic(1)" >
<img class="floatright" id="rightlogo" alt="" src="assets/ro.png" onclick="magic(1)">
<div id="titletxt"><a href="index.html">Portal Guns 2.0</a></div>
</div>
<div id="timestampdiv"></div>
<div id="gordonstats"></div>
<div id="chellstats"></div>
<input id="buttonload" type="button" onclick="loaddata2(2);" value="<<" style="width:40px;">
<input id="buttonload" type="button" onclick="loaddata2(-1);" value="<" style="width:40px;">
<input id="currentid" type="number" min="0" value="0" style="width:50px;" onchange="updatepage(this)">
<input id="buttonload" type="button" onclick="loaddata2(1);" value= ">" style="width:40px;">
<input id="buttonload" type="button" onclick="loaddata2(2);" value=">>" style="width:40px;">
<br><br>
<img class="portal_image" id="portal_back" alt="" src="assets/blank.png">
<img class="portal_image" id="portal_front" alt="" src="assets/orange_portal.png">

<div class="portal_image" id="portaloverlay">

<div id="floatmagic">

<a href="http://192.168.1.22">
<div class="floatleft iconbutton" id="gordondiv" onmouseenter="swapper(1,'gordon')" onmouseleave="swapper(0,'gordon')">
<i class="fa fa-wrench fa-2x" id="gordonicon"></i>Gordon</div>
</a>


<a href="http://192.168.1.23">
<div class="floatright iconbutton" id="chelldiv" onmouseenter="swapper(1,'chell')" onmouseleave="swapper(0,'chell')">
<i class="fa fa-wrench fa-2x" id="chellicon"></i>Chell</div>
</a>

</div>
</div>
<script src="portal.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script>

var magic_clicks = 0;
var button_hovers = 0;
var portal_color_saved = 0;

var views = getCookie("views");
if (views == ""){
	setCookie("views", "0", 365);
	views = 0;
}else{
	views= parseInt(views);
}

loaddata(-1);

function magic(num){
	increment_idle_view();
	if (num == 0){
		floatmagic.style.display = 'none';
		magic_clicks = 0;
	}else{
		magic_clicks += num;		
	}
	if (magic_clicks ==  5){
		floatmagic.style.display = 'inline';
		timestampdiv.innerHTML = "Private Management Links";
		gordonstats.innerHTML = "Enjoy!";
		chellstats.innerHTML = "Portal Gun Wifi Network Only!";
	}	
}

function updatepage(element) {
	loaddata(element.value);
}

function loaddata2(num){
	magic(0);
	currentid.value = parseInt(currentid.value) + num;
	loaddata(currentid.value);
}

function loaddata(number) {
	$.post('index_get.php', {id: number,live: 0}, function(data) {
		var line = data.split("\t");
		if (line.length == 17){
		
			var timestamp = line[0];
			var id = parseInt(line[1]);
			var synced = parseInt(line[2]);
			
			var g_live = parseInt(line[3]);
			var g_time = line[4];
			var g_lag = parseFloat(line[5]);
			var g_volts = parseFloat(line[6]);
			var g_temp1 = parseFloat(line[7]);
			var g_temp2 = parseFloat(line[8]);
			
			var c_live = parseInt(line[9]);
			var c_time = line[10];
			var c_lag = parseFloat(line[11]);
			var c_volts = parseFloat(line[12]);
			var c_temp1 = parseFloat(line[13]);
			var c_temp2 = parseFloat(line[14]);
			
			var g_state = parseFloat(line[15]);
			var c_state = parseFloat(line[16]);
			
			currentid.value = id;
			timestampdiv.innerHTML = timestamp;
			
			if (g_live){
				gordonstats.innerHTML = "Gordon: " + g_volts + "V " + g_lag + "ms " + g_temp1 + "F " + g_temp2 + "F";
			}else{
				gordonstats.innerHTML = "Gordon Last Seen at " + g_time;
			}
			if (c_live){
				chellstats.innerHTML = "Chell: " + c_volts + "V " + c_lag + "ms " + c_temp1 + "F " + c_temp2 + "F";
			}else{
				gordonstats.innerHTML = "Chell Last Seen at " + c_time;
			}
			
			if (g_state < 0 ){
				portal_front.src = "assets/orange_portal.png"
				portal_back.src = "getimage.php?id=" +id;
				portal_color_saved = 0;
			}else if (c_state < 0){
				portal_color_saved = 1;
				portal_front.src = "assets/blue_portal.png"
				portal_back.src = "getimage.php?id=" +id;
			}else{
				if (synced == 1){
					if (portal_color_saved == 1 ){
						portal_back.src = "assets/blue_0.jpg";
					}else if (portal_color_saved == 0){
						portal_back.src  = "assets/orange_0.jpg"; 
					}
				}else{
					portal_back.src  = "assets/blank.png"; 
				}
				
				
			}
			
			
			
		}
	});
}

</script>
</body>
</html>